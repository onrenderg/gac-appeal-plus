@model DigitalNagrik.Areas.GridView.Data.SearchAppealDetails
@using DigitalNagrik.Models
@{
    ViewBag.Title = "SearchApppeal";
    Layout = "~/Views/Shared/_LayoutDashGAC.cshtml";
    Dictionary<string, string> LabelDictionary = ViewData["LabelDictionary"] as Dictionary<string, string>;
}
<style>
    .min-vh-50 {
        min-height: 70vh !important;
    }
</style>
<div class="col-lg-12 min-vh-50">
    <div class="row p-3">
        <div class="col-6">
            <h3 class="ms-3 mt-2"><i class="bi bi-search me-1 text-primary"></i>Search Appeal Details</h3>
        </div>
        <div class="col-6">
            <a class="btn btn-warning float-end me-2" href='@Url.Action("Index", "GACGridViewInbox", new {Area="Gridview"})'>
                <i class="bx bx-arrow-back align-middle"></i> @LabelDictionary["Back"]
            </a>
        </div>
    </div>
    <hr class="m-0" />
    @using (Html.BeginForm("GetAppealDetails", "AppealHistoryReport", FormMethod.Post, new { @class = "frmSearchAppeal" }))
    {
        @Html.AntiForgeryToken()
        <div class="row mt-2 ms-3" style="font-size:17px">
            <div class="col-md-3">
                <div class="row">
                    <div class="col-lg-12">
                        <h4><i class="bi bi-list-check me-1 text-danger"></i>Parameters</h4>
                    </div>
                    <hr class="mt-0" />
                    <div class="col-md-12 mb-2">
                        <label class="custom-input-label"><b>Search By:</b></label><span class="text-danger"> *</span>
                        @Html.RadioButtonFor(x => x.SearchParameter, "A", new { @class = "form-check-input" })
                        <label class="form-check-label me-2">
                            Appeal ID
                        </label>
                        @Html.RadioButtonFor(x => x.SearchParameter, "N", new { @class = "form-check-input" })
                        <label class="form-check-label me-2">
                            Name
                        </label>
                        @Html.RadioButtonFor(x => x.SearchParameter, "M", new { @class = "form-check-input" })
                        <label class="form-check-label">
                            Mobile No
                        </label>
                        <br />
                        @Html.ValidationMessageFor(x => x.SearchParameter)
                    </div>
                    <div class="col-lg-12 mb-2">
                        <label class="custom-input-label">Search Text</label><span class="text-danger"> *</span>
                        @Html.TextBoxFor(x => x.SearchText, new { @id = "SearchText", @class = "form-control DisabledInputs", maxlength = "100", placeholder = "Enter Search Text", @autocomplete = "off" })
                        @Html.ValidationMessageFor(x => x.SearchText)
                    </div>
                    <hr />
                    <div class="col-lg-12 text-center">
                        <button type="button" class="btn btn-primary" onclick="GetAppealDetails($(this))" id="btnSearch"><i class="bx bx-search align-middle mr-1"></i>Search</button>
                        <a class="btn btn-danger" href="@Url.Action("SearchAppeal", "AppealHistoryReport", new { Area = "Gridview" })"><i class="bx bx-window-close align-middle mr-1"></i>Cancel</a>
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <div class="row">
                    <div class="gv-container-action-form">
                        @*@{ Html.RenderAction("ListofAppeals", "IntermediaryDashboard", new { Area = "Intermediary" }); }*@
                    </div>
                </div>
            </div>
        </div>
    }
</div>
<div class="modal fade" id="gv-modal-tracker" data-bs-backdrop="static" data-bs-keyboard="false" aria-modal="true" role="dialog">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content" id="gv-modal-tracker-content"></div>
    </div>
</div>

<div class="modal fade" id="gv-action-modal" data-bs-backdrop="static" data-bs-keyboard="false" aria-modal="true" role="dialog">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content" id="gv-action-modal-content"></div>
    </div>
</div>
<script>
    $.validator.unobtrusive.parse($(".frmSearchAppeal"));
    var _AppealListContainer = $(".gv-container-action-form");
    var _BlankAppealHtml = '<div class="px-4 py-3 font-sm text-center"><div class="spinner-border spinner-border text-primary" role="status"><span class="visually-hidden">@LabelDictionary["FetchingData"]</span></div><br>@LabelDictionary["FetchingData"]</div>';
    function GetAppealDetails(element) {
        var form = element.closest('form');
        if (form.valid()) {
            _AppealListContainer.html(_BlankAppealHtml);
            setTimeout(function () { $.ajax({ url: '@Url.Action("GetAppealDetails", "AppealHistoryReport", new { Area = "GridView" })',  data: $(".frmSearchAppeal").serialize(), type: "POST", dataType: "HTML", async: false, success: function (data) { if (data) { _AppealListContainer.html(data); } }, }); }, 400);
        }
    }
    var _LoadHtml = '<div class="px-4 py-5 text-center"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div><br>@LabelDictionary["FetchingData"]</div>';
    var _AppealDetailsContainer = $(".gv-container-appealdetails");
    var _AppealActionFormContainer = $(".gv-container-action-form");
    var _AppealModalActionFormContainer = $("#gv-action-modal-content");
    var _TrackContainer = $("#gv-modal-tracker-content");
    var _FormLoadHtml_Grid = '<div class="px-4 py-3 font-sm text-center"><div class="spinner-border spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div><br>@LabelDictionary["FetchingData"]</div>';
    var _FormLoadHtml_Modal = '<div class="px-4 py-4 my-4 h-100 text-center"><div class="spinner-border spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div><br>@LabelDictionary["FetchingData"]</div>';

   function TakeAction(element, ActionContainerType) {
        var URL = element.data("url"); var ActionContainer;
        if (ActionContainerType == "G") {
            ActionContainer = _AppealActionFormContainer; _AppealModalActionFormContainer.html(''); ActionContainer.html(_FormLoadHtml_Grid);
        }
        else if (ActionContainerType == "M") {
            var ModalSizeClass = element.data('modalclass');
            $("#gv-action-modal").find('.modal-dialog').removeClass().addClass('modal-dialog modal-' + ModalSizeClass); $("#gv-action-modal").modal('show');
            ActionContainer = _AppealModalActionFormContainer; ActionContainer.html(_FormLoadHtml_Modal);
        }
        setTimeout(function () { $.ajax({ url: URL, type: "GET", dataType: "HTML", async: false, success: function (data) { if (data) { ActionContainer.html(data); } } }); }, 400);
    }

    function ViewTracker(element) {
        $("#gv-modal-tracker").modal('show'); _TrackContainer.html(''); _TrackContainer.html(_FormLoadHtml_Modal);
        var URL = element.data("url");
        setTimeout(function () { $.ajax({ url: URL, type: "GET", dataType: "HTML", async: false, success: function (data) { if (data) { _TrackContainer.html(data); } } }); }, 400);
    }
</script>

